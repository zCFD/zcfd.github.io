<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>zCFD Functions &#8212; zCFD User Guide v2023.06.5001-145-gc7dc1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=7ede516a" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=659bf730" />
    <script src="_static/documentation_options.js?v=497ff1b0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="_static/fav.png"/>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mesh Conversion" href="meshutil.html" />
    <link rel="prev" title="Output variables" href="reference_guide/variables.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="zcfd-functions">
<h1>zCFD Functions<a class="headerlink" href="#zcfd-functions" title="Link to this heading">¶</a></h1>
<p>Several parameters in the zCFD control dictionary will accept functions as arguments. These functions are then evaluated by the solver when required. This allows you to customise &amp; tune to solver as it runs.</p>
<section id="scale-mesh-function">
<span id="scale-function"></span><h2>Scale Mesh Function<a class="headerlink" href="#scale-mesh-function" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Transform the location of a supplied point.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Valid for parameter</strong></p></td>
<td><p><a class="reference internal" href="reference_guide/reference.html#scale-mesh"><span class="std std-ref">scale_mesh</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Parameters</strong></p></td>
<td><p>[x, y, z]: Point to transform</p></td>
</tr>
<tr class="row-even"><td><p><strong>Returns</strong></p></td>
<td><p>{‘coord’: [x, y, z]}: Transformed coordinates</p></td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Custom function to scale z coordinate by 100</span>
<span class="k">def</span> <span class="nf">my_scale_func</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
    <span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mf">100.0</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;coord&#39;</span> <span class="p">:</span> <span class="n">point</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
 <span class="o">...</span>
 <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="n">my_scale_func</span>
 <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="transform-mesh-function">
<span id="id1"></span><h2>Transform Mesh Function<a class="headerlink" href="#transform-mesh-function" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Transform the location of a supplied point.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Valid for parameter</strong></p></td>
<td><p><a class="reference internal" href="reference_guide/transforms.html#mesh-transform"><span class="std std-ref">mesh transform func</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Parameters</strong></p></td>
<td><p>[x, y, z]: Point to transform</p></td>
</tr>
<tr class="row-even"><td><p><strong>Returns</strong></p></td>
<td><p>{“v1”: x, “v2”: y, “v3”: z}: Transformed coordinates</p></td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rotation</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="k">def</span> <span class="nf">my_transform</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
  <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">zutil</span><span class="o">.</span><span class="n">rotate_vector</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
  <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;v1&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;v2&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;v3&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]}</span>
</pre></div>
</div>
</section>
<section id="ramp-cfl-function">
<span id="ramp-function"></span><h2>Ramp CFL Function<a class="headerlink" href="#ramp-cfl-function" title="Link to this heading">¶</a></h2>
<p>There may be cases where more detailed control of the CFL number is desired - for example in some aerodynamic simulations where a specific physical event occurs at a given time.  The CFL Ramp function lets you do this.</p>
<p>The ramp function returns a single floating point number (the CFL number) and can also be used to update elements of the ‘cfl’ Python object such as cfl.min_cfl, cfl.max_cfl, cfl.current_cfl, cfl.coarse_cfl, cfl.transport_cfl, cfl.cfl_ramp, cfl.cfl_pmg, or cfl.transport_cfl_pmg.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Provide a dynamic CFL number</p></td>
</tr>
<tr class="row-even"><td><p><strong>Valid for parameter</strong></p></td>
<td><p><a class="reference internal" href="reference_guide/time.html#cfl-control"><span class="std std-ref">ramp func</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Parameters</strong></p></td>
<td><p>solve_cycle, real_time_cycle, cfl</p></td>
</tr>
<tr class="row-even"><td><p><strong>Returns</strong></p></td>
<td><p>cfl: float</p></td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Custom function to ramp CFL based on cycle, updates the cfl object variables and returns a CFL</span>
<span class="k">def</span> <span class="nf">my_cfl_ramp</span><span class="p">(</span><span class="n">solve_cycle</span><span class="p">,</span> <span class="n">real_time_cycle</span><span class="p">,</span> <span class="n">cfl</span><span class="p">):</span>
  <span class="n">cfl</span><span class="o">.</span><span class="n">min_cfl</span> <span class="o">=</span> <span class="mf">1.0</span>
  <span class="n">cfl</span><span class="o">.</span><span class="n">max_cfl</span> <span class="o">=</span> <span class="mf">10.0</span>
  <span class="n">cfl</span><span class="o">.</span><span class="n">cfl_ramp</span> <span class="o">=</span> <span class="mf">1.005</span>
  <span class="n">cfl_transport</span> <span class="o">=</span> <span class="mf">5.0</span>
  <span class="k">if</span> <span class="n">solve_cycle</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
      <span class="n">cfl_new</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">cfl</span><span class="o">.</span><span class="n">min_cfl</span> <span class="o">*</span> <span class="n">cfl</span><span class="o">.</span><span class="n">cfl_ramp</span> <span class="o">**</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solve_cycle</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">cfl</span><span class="o">.</span><span class="n">max_cfl</span><span class="p">)</span>
      <span class="n">cfl</span><span class="o">.</span><span class="n">transport_cfl</span> <span class="o">=</span> <span class="n">cfl_transport</span> <span class="o">*</span> <span class="n">cfl_new</span> <span class="o">/</span> <span class="n">cfl</span><span class="o">.</span><span class="n">max_cfl</span>
      <span class="k">return</span> <span class="n">cfl_new</span>

  <span class="k">elif</span> <span class="n">solve_cycle</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
      <span class="n">cfl</span><span class="o">.</span><span class="n">trasport_cfl</span> <span class="o">=</span> <span class="mf">7.5</span>
      <span class="n">cfl</span><span class="o">.</span><span class="n">max_cfl</span> <span class="o">=</span> <span class="mf">15.0</span>
      <span class="k">return</span> <span class="mf">15.0</span>

  <span class="k">else</span><span class="p">:</span>
      <span class="n">cfl</span><span class="o">.</span><span class="n">transport_cfl</span> <span class="o">=</span> <span class="mf">10.0</span>
      <span class="n">cfl</span><span class="o">.</span><span class="n">max_cfl</span> <span class="o">=</span> <span class="mf">30.0</span>
      <span class="k">return</span> <span class="mf">30.0</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
 <span class="o">...</span>
 <span class="s1">&#39;time marching&#39;</span><span class="p">:</span> <span class="p">{</span>
   <span class="o">...</span>
   <span class="s1">&#39;ramp func&#39;</span><span class="p">:</span> <span class="n">my_cfl_ramp</span><span class="p">,</span>
   <span class="o">...</span>
   <span class="p">}</span>
 <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="transform-function">
<span id="id2"></span><h2>Transform Function<a class="headerlink" href="#transform-function" title="Link to this heading">¶</a></h2>
<p>A transformation function my be supplied to the force report block to transform the force into a different coordinate system. This is particularly useful for reporting lift and drag, which are often rotated from the solver coordinate system.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Transform a supplied point - rotate, scale or translate.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Valid for parameter</strong></p></td>
<td><p><a class="reference internal" href="reference_guide/report.html#forces"><span class="std std-ref">Forces transform</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Parameters</strong></p></td>
<td><p>(x, y, z): floats</p></td>
</tr>
<tr class="row-even"><td><p><strong>Returns</strong></p></td>
<td><p>(x, y, z): floats</p></td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#zutil is a Zenotech python library providing various utilities, available within a zCFD installation</span>
<span class="kn">import</span> <span class="nn">zutil</span>

<span class="c1"># Angle of attack</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="c1"># Transform into wind axis</span>
<span class="k">def</span> <span class="nf">my_transform</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>
    <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]</span>
    <span class="n">v</span> <span class="o">=</span>  <span class="n">zutil</span><span class="o">.</span><span class="n">rotate_vector</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">return</span>  <span class="p">{</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]}</span>
</pre></div>
</div>
</section>
<section id="initialisation-function">
<span id="initial-function"></span><h2>Initialisation Function<a class="headerlink" href="#initialisation-function" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Provide the initial flow field variables on a cell-by-cell basis</p></td>
</tr>
<tr class="row-even"><td><p><strong>Valid for parameter</strong></p></td>
<td><p><a class="reference internal" href="reference_guide/reference.html#initial-state"><span class="std std-ref">initial</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Parameters</strong></p></td>
<td><p>kwargs dictionary containing “pressure”, “temperature”, “velocity”, “wall_distance”, “location”</p></td>
</tr>
<tr class="row-even"><td><p><strong>Returns</strong></p></td>
<td><p>dictionary containing one or more of “pressure”, “temperature” or “velocity”</p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_initialisation</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
  <span class="c1"># Dimensional primitive variables</span>
  <span class="n">pressure</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span>
  <span class="n">temperature</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span>
  <span class="n">velocity</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;velocity&#39;</span><span class="p">]</span>
  <span class="n">wall_distance</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;wall_distance&#39;</span><span class="p">]</span>
  <span class="c1"># Cell centre localtion [X, Y, Z]</span>
  <span class="n">location</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span>

  <span class="k">if</span> <span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">10.0</span><span class="p">:</span>
    <span class="n">velocity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">2.0</span>

  <span class="c1"># Return a dictionary with user defined quantity.</span>
  <span class="k">return</span> <span class="p">{</span> <span class="s1">&#39;velocity&#39;</span> <span class="p">:</span> <span class="n">velocity</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
 <span class="o">...</span>
 <span class="s1">&#39;initial&#39;</span><span class="p">:</span> <span class="p">{</span>
   <span class="o">...</span>
   <span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="n">my_initialisation</span><span class="p">,</span>
   <span class="o">...</span>
   <span class="p">}</span>
 <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="driven-initial-condition">
<span id="driving-function"></span><h2>Driven initial condition<a class="headerlink" href="#driven-initial-condition" title="Link to this heading">¶</a></h2>
<p>A ‘driving function’ provides another way of prescribing a farfield initial condition, which on evaluation returns an initial condition dictionary.</p>
<p>The driving function is re-evaluated at zCFD’s reporting frequency, meaning that the condition (e.g. inlet velocity) can be programmed to change as the simulation progresses.</p>
<p>At startup, the function is only provided with the key word arguments RealTimeStep=0, Cycle=0. However, the driving function is subsequently provided with key word arguments containing all the data in the ‘_report.csv’ file, evaluated at the previous timestep. For any driven initial condition, every value in the initial condition dictionary is also appended to the _report.csv file.</p>
<p>This means that the initial condition can be programmed to respond to the flow. An example is shown below, where the driven IC will continually adjust inlet angle of attack until a specified lift coefficient is achieved.</p>
<p>If the driven initial condition has been programmed to respond to changes in the flow, it is important to ensure that the flow has had enough time to propagate from the farfield through to the region of interest and settle before readjusting the driven initial condition. For simulations where the farfield is distant from the geometry, local and implicit time-stepping will likely give the fastest propagation of adjusted farfield conditions through the domain.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Driven initial conditions <strong>cannot</strong> be used as reference conditions, to initialise the flow (e.g ‘IC_1’) or within a restarted simulation.</p>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Provides a farfield initial condition that can respond to changes in the flow.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Valid for parameter</strong></p></td>
<td><p><a class="reference internal" href="reference_guide/initial.html#initial-conditions"><span class="std std-ref">initial condition</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Parameters</strong></p></td>
<td><p>kwargs dictionary containing “RealTimeStep”, “Cycle” and all reporting variables</p></td>
</tr>
<tr class="row-even"><td><p><strong>Returns</strong></p></td>
<td><p>dictionary containing valid keys for an <a class="reference internal" href="reference_guide/initial.html#initial-conditions"><span class="std std-ref">initial condition</span></a></p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">example_ic_func</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Example driver function to target a lift coefficient by varying</span>
<span class="sd">  angle of attack</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">alpha_init</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Initial angle of attack</span>
  <span class="n">lift_target</span><span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># Targeted lift coefficient</span>
  <span class="n">update_period</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># How often alpha should be updated</span>
  <span class="n">flow_settling_period</span> <span class="o">=</span> <span class="mi">1500</span>

  <span class="n">assumed_d_cL_d_alpha</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># Used to estimate alpha which would give required lift</span>
  <span class="n">relaxation_factor</span> <span class="o">=</span> <span class="mf">1.15</span> <span class="c1"># &lt;1: under-relaxation, &gt;1: over-relaxation</span>


  <span class="k">if</span> <span class="s1">&#39;lift_target_alpha&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="c1"># If timestep &gt; 1</span>
      <span class="n">alpha_current</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;lift_target_alpha&#39;</span><span class="p">]</span>
      <span class="n">F_xyz</span> <span class="o">=</span> <span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;wall_Fx&#39;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;wall_Fy&#39;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;wall_Fz&#39;</span><span class="p">]]</span>
      <span class="n">F_LDS</span> <span class="o">=</span> <span class="n">zutil</span><span class="o">.</span><span class="n">rotate_vector</span><span class="p">(</span><span class="n">F_xyz</span><span class="p">,</span> <span class="n">alpha_current</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
      <span class="n">lift_current</span> <span class="o">=</span> <span class="n">F_LDS</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Lift coefficient, having rotated to account for alpha</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="n">lift_current</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># placeholder value</span>

  <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Cycle&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">flow_settling_period</span><span class="p">:</span>
      <span class="n">alpha_new</span> <span class="o">=</span> <span class="n">alpha_init</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Cycle&#39;</span><span class="p">]</span> <span class="o">%</span> <span class="n">update_period</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">d_cL_required</span> <span class="o">=</span> <span class="n">lift_target</span> <span class="o">-</span> <span class="n">lift_current</span>
          <span class="n">d_alpha</span> <span class="o">=</span> <span class="n">relaxation_factor</span> <span class="o">/</span> <span class="n">assumed_d_cL_d_alpha</span> <span class="o">*</span>  <span class="n">d_cL_required</span>
          <span class="n">alpha_new</span> <span class="o">=</span> <span class="n">alpha_current</span> <span class="o">+</span> <span class="n">d_alpha</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Alpha updated from </span><span class="si">{}</span><span class="s2"> to </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha_current</span><span class="p">,</span> <span class="n">alpha_new</span><span class="p">),</span> <span class="n">flush</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="n">alpha_new</span> <span class="o">=</span> <span class="n">alpha_current</span>

  <span class="n">dict_out</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
      <span class="s2">&quot;pressure&quot;</span><span class="p">:</span> <span class="mf">101325.0</span><span class="p">,</span>
      <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s1">&#39;mach&#39;</span> <span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
          <span class="s1">&#39;vector&#39;</span> <span class="p">:</span> <span class="n">zutil</span><span class="o">.</span><span class="n">vector_from_angle</span><span class="p">(</span><span class="n">alpha_new</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
          <span class="p">},</span>
      <span class="s2">&quot;reynolds no&quot;</span><span class="p">:</span> <span class="mf">6.0e6</span><span class="p">,</span>
      <span class="s2">&quot;eddy viscosity ratio&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
      <span class="s2">&quot;monitor&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Monitor entries can be floats or lists of floats</span>
                    <span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;lift_target&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="n">alpha_new</span><span class="p">,</span>   <span class="c1"># Extra keys can be added to a driven IC dictionary,</span>
                    <span class="s2">&quot;lift&quot;</span><span class="p">:</span> <span class="n">lift_current</span><span class="p">,</span>  <span class="c1"># allowing monitoring of key parameters flow in the _report.csv</span>
                  <span class="p">},</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="n">dict_out</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
 <span class="o">...</span>
 <span class="s1">&#39;IC_2&#39;</span> <span class="p">:</span> <span class="n">example_ic_func</span>
 <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="static-pressure-ratio">
<span id="static-pressure-ratio-function"></span><h2>Static Pressure Ratio<a class="headerlink" href="#static-pressure-ratio" title="Link to this heading">¶</a></h2>
<p>The python function takes in three values (x, y, z) and returns the static pressure ratio.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Returns a static pressure ratio for a given point.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Valid for parameter</strong></p></td>
<td><p><a class="reference internal" href="reference_guide/reference_conditions.html#reference-conditions"><span class="std std-ref">Static Pressure Ratio</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Parameters</strong></p></td>
<td><p>(x, y, z): floats</p></td>
</tr>
<tr class="row-even"><td><p><strong>Returns</strong></p></td>
<td><p>float</p></td>
</tr>
</tbody>
</table>
</section>
<section id="total-pressure-ratio">
<span id="total-pressure-ratio-function"></span><h2>Total Pressure Ratio<a class="headerlink" href="#total-pressure-ratio" title="Link to this heading">¶</a></h2>
<p>The python function takes in three values (x, y, z) and returns the total pressure ratio.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Returns a total pressure ratio for a given point.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Valid for parameter</strong></p></td>
<td><p><a class="reference internal" href="reference_guide/reference_conditions.html#reference-conditions"><span class="std std-ref">Total Pressure Ratio</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Parameters</strong></p></td>
<td><p>(x, y, z): floats</p></td>
</tr>
<tr class="row-even"><td><p><strong>Returns</strong></p></td>
<td><p>float</p></td>
</tr>
</tbody>
</table>
</section>
<section id="total-temperature-ratio">
<span id="total-temperature-ratio-function"></span><h2>Total Temperature Ratio<a class="headerlink" href="#total-temperature-ratio" title="Link to this heading">¶</a></h2>
<p>The python function takes in three values (x, y, z) and returns the temperature pressure ratio.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Returns a total temperature ratio for a given point.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Valid for parameter</strong></p></td>
<td><p><a class="reference internal" href="reference_guide/reference_conditions.html#reference-conditions"><span class="std std-ref">Total Temperature Ratio</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Parameters</strong></p></td>
<td><p>(x, y, z): floats</p></td>
</tr>
<tr class="row-even"><td><p><strong>Returns</strong></p></td>
<td><p>float</p></td>
</tr>
</tbody>
</table>
</section>
<section id="direction-vector">
<span id="direction-vector-function"></span><h2>Direction Vector<a class="headerlink" href="#direction-vector" title="Link to this heading">¶</a></h2>
<p>The python function takes in three values (x, y, z) and returns a tuple (x, y, z).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Returns a direction vector for a given point.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Valid for parameter</strong></p></td>
<td><p><a class="reference internal" href="reference_guide/reference_conditions.html#reference-conditions"><span class="std std-ref">vector</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Parameters</strong></p></td>
<td><p>(x, y, z): floats</p></td>
</tr>
<tr class="row-even"><td><p><strong>Returns</strong></p></td>
<td><p>(x, y, z): floats</p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inflow_direction</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
  <span class="c1"># x, y, and z are the coordinates of the face centre</span>
  <span class="n">cen</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
  <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">cen</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">z1</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">cen</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
  <span class="n">rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">z1</span><span class="o">*</span><span class="n">z1</span> <span class="o">+</span> <span class="n">y1</span><span class="o">*</span><span class="n">y1</span><span class="p">)</span>
  <span class="n">phi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">)</span>
  <span class="n">angle</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.24</span>
  <span class="n">x2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
  <span class="n">y2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
  <span class="n">z2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
 <span class="o">...</span>
 <span class="s1">&#39;IC_2&#39;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;reference&#39;</span> <span class="p">:</span> <span class="s1">&#39;IC_1&#39;</span><span class="p">,</span>
      <span class="s1">&#39;vector&#39;</span> <span class="p">:</span> <span class="n">inflow_direction</span>
      <span class="p">},</span>
 <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/ZCFD_Mark_CMYK.png" alt="Logo"/>
            </a></p><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="execution.html">Running zCFD</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference_guide/intro.html">Reference Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">zCFD Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#scale-mesh-function">Scale Mesh Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transform-mesh-function">Transform Mesh Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ramp-cfl-function">Ramp CFL Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transform-function">Transform Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#initialisation-function">Initialisation Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#driven-initial-condition">Driven initial condition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#static-pressure-ratio">Static Pressure Ratio</a></li>
<li class="toctree-l2"><a class="reference internal" href="#total-pressure-ratio">Total Pressure Ratio</a></li>
<li class="toctree-l2"><a class="reference internal" href="#total-temperature-ratio">Total Temperature Ratio</a></li>
<li class="toctree-l2"><a class="reference internal" href="#direction-vector">Direction Vector</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="meshutil.html">Mesh Conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualisation.html">Visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="pdf.html">PDF copy</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016-23, Zenotech Ltd.
      
      |
      <a href="_sources/functions.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-32675146-1']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
  </body>
</html>